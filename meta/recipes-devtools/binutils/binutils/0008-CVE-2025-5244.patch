From e7823722701a1a476a7a5e8462ece8a7133577df Mon Sep 17 00:00:00 2001
From: Alan Modra <amodra@gmail.com>
Date: Thu, 10 Apr 2025 19:41:49 +0930
Subject: [PATCH 08/12] CVE-2025-5244

We missed one place where it is necessary to check for empty groups.

	PR 32858
	* elflink.c (elf_gc_sweep): Protect against empty group.

Signed-off-by: Siddharth Doshi <sdoshi@mvista.com>
---
 bfd/elflink.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/bfd/elflink.c b/bfd/elflink.c
index 31b10878844..4c3b8a586fb 100644
--- a/bfd/elflink.c
+++ b/bfd/elflink.c
@@ -13452,7 +13452,8 @@ elf_gc_sweep (bfd *abfd, struct bfd_link_info *info)
 	  if (o->flags & SEC_GROUP)
 	    {
 	      asection *first = elf_next_in_group (o);
-	      o->gc_mark = first->gc_mark;
+	      if (first != NULL)
+		o->gc_mark = first->gc_mark;
 	    }
 
 	  if (o->gc_mark)
-- 
2.24.4

