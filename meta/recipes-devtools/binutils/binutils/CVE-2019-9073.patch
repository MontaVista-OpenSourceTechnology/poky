From 24471542d964097d82f2e590721a3356105ce1b7 Mon Sep 17 00:00:00 2001
From: Vijay Anusuri <vanusuri@mvista.com>
Date: Tue, 24 Jan 2023 11:54:36 +0000
Subject: [PATCH] PR24233, Out of memory

PR 24233
* objdump.c (dump_bfd_private_header): Print warning if
bfd_print_private_bfd_data returns false.

Upstream-Status: Backport [https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;h=7d272a55caebfc26ab2e15d1e9439bac978b9bb7]
CVE: CVE-2019-9073
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 binutils/objdump.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/binutils/objdump.c b/binutils/objdump.c
index aff9b011083..1e5f6ca4890 100644
--- a/binutils/objdump.c
+++ b/binutils/objdump.c
@@ -2921,7 +2921,9 @@ dump_bfd_header (bfd *abfd)
 static void
 dump_bfd_private_header (bfd *abfd)
 {
-  bfd_print_private_bfd_data (abfd, stdout);
+  if (!bfd_print_private_bfd_data (abfd, stdout))
+    non_fatal (_("warning: private headers incomplete: %s"),
+              bfd_errmsg (bfd_get_error ()));
 }
 
 static void
-- 
2.18.2

