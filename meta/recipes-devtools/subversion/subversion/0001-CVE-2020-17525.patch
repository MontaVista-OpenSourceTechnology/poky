From 7dfc1f918e8f52465da5b5a15c5558b3d6a6e592 Mon Sep 17 00:00:00 2001
From: Hitendra Prajapati <hprajapati@mvista.com>
Date: Mon, 8 Nov 2021 09:57:25 +0530
Subject: [PATCH] CVE-2020-17525

Upstream-Status: Backport from https://subversion.apache.org/security/CVE-2020-17525-advisory.txt

Signed-off-by: Hitendra Prajapati <hprajapati@mvista.com>
---
 subversion/libsvn_repos/config_pool.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/subversion/libsvn_repos/config_pool.c b/subversion/libsvn_repos/config_pool.c
index 164bd98..163feb7 100644
--- a/subversion/libsvn_repos/config_pool.c
+++ b/subversion/libsvn_repos/config_pool.c
@@ -336,6 +336,10 @@ find_repos_config(svn_config_t **cfg,
       /* Search for a repository in the full path. */
       repos_root_dirent = svn_repos_find_root_path(dirent, scratch_pool);
 
+      if (!repos_root_dirent)
+        return svn_error_createf(SVN_ERR_RA_LOCAL_REPOS_NOT_FOUND, NULL,
+                             "Unable to find repository at '%s'", dirent);
+
       /* Attempt to open a repository at repos_root_dirent. */
       SVN_ERR(svn_repos_open3(&repos, repos_root_dirent, NULL,
                               scratch_pool, scratch_pool));
-- 
2.25.1

