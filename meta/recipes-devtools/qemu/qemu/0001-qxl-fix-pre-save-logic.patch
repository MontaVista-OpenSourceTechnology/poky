From 1e5b424ebb859bfd661cb4bd6b7dc958f5c1affa Mon Sep 17 00:00:00 2001
From: Vijay Anusuri <vanusuri@mvista.com>
Date: Mon, 30 Jan 2023 05:59:01 +0000
Subject: [PATCH] qxl: fix pre-save logic

Oops.  Logic is backwards.

Fixes: 39b8a18 ("qxl: remove assert in qxl_pre_save.")
Resolves: https://gitlab.com/qemu-project/qemu/-/issues/610
Resolves: https://bugzilla.redhat.com//show_bug.cgi?id=2002907
Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Reviewed-by: Daniel P. Berrangé <berrange@redhat.com>
Reviewed-by: Marc-André Lureau <marcandre.lureau@redhat.com>
Message-Id: <20210910094203.3582378-1-kraxel@redhat.com>

Upstream-Status: Backport [https://github.com/qemu/qemu/commit/eb94846280df3f1e2a91b6179fc05f9890b7e384]
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 hw/display/qxl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/hw/display/qxl.c b/hw/display/qxl.c
index f304e429..e4e0d451 100644
--- a/hw/display/qxl.c
+++ b/hw/display/qxl.c
@@ -2223,7 +2223,7 @@ static void qxl_pre_save(void *opaque)
     } else {
         d->last_release_offset = (uint8_t *)d->last_release - ram_start;
     }
-    if (d->last_release_offset < d->vga.vram_size) {
+    if (d->last_release_offset >= d->vga.vram_size) {
         return 1;
     }
 }
-- 
2.18.2

