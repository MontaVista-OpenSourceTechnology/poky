regcomp.c: Prevent integer overflow from nested regex quantifiers.

(CVE-2020-10543) On 32bit systems the size calculations for nested regular
expression quantifiers could overflow causing heap memory corruption.

Fixes: Perl/perl-security#125
(cherry picked from commit bfd31397db5dc1a5c5d3e0a1f753a4f89a736e71)

Upstream-Status: Backport
CVE: CVE-2020-10543
Signed-off-by: Armin Kuster <akuster@mvista.com>

Index: perl-5.24.4/regcomp.c
===================================================================
--- perl-5.24.4.orig/regcomp.c
+++ perl-5.24.4/regcomp.c
@@ -5070,6 +5070,12 @@ S_study_chunk(pTHX_ RExC_state_t *pRExC_
 		    (void)ReREFCNT_inc(RExC_rx_sv);
 		}
 
+        if ( ( minnext > 0 && mincount >= SSize_t_MAX / minnext )
+            || min >= SSize_t_MAX - minnext * mincount )
+        {
+            FAIL("Regexp out of space");
+        }
+
 		min += minnext * mincount;
 		is_inf_internal |= deltanext == SSize_t_MAX
                          || (maxcount == REG_INFTY && minnext + deltanext > 0);
