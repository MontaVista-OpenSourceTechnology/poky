From 1ba4cef6186d783fd1b3567ea9c964c303af5911 Mon Sep 17 00:00:00 2001
From: Vivek Kumbhar <vkumbhar@mvista.com>
Date: Wed, 22 May 2024 05:46:38 +0000
Subject: [PATCH] CVE-2023-27349

---
 profiles/audio/avrcp.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/profiles/audio/avrcp.c b/profiles/audio/avrcp.c
index 0233d53..f44b152 100644
--- a/profiles/audio/avrcp.c
+++ b/profiles/audio/avrcp.c
@@ -3846,6 +3846,12 @@ static gboolean avrcp_handle_event(struct avctp *conn, uint8_t code,
	case AVRCP_EVENT_UIDS_CHANGED:
		avrcp_uids_changed(session, pdu);
		break;
+	default:
+		if (event > AVRCP_EVENT_LAST) {
+			warn("Unsupported event: %u", event);
+			return FALSE;
+		}
+		break;
	}

	session->registered_events |= (1 << event);
--
2.24.4
