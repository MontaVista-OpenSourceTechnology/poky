From 99c3dd8b0ded5993ae97cfca523fec55cfa091d2 Mon Sep 17 00:00:00 2001
From: Yunhan Wang <yunhanw@google.com>
Date: Tue, 3 Oct 2017 11:35:07 -0700
Subject: [PATCH 06/12] gatt: Fix sending indications with proxy

When using AcquireNotify with indication, the proxy needs to be filled in
send_notification_to_devices so as to get indication confirmation in
applciation.

Upstream Status: Backport [patch #6]
CVE: CVE-2021-43400
Signed-off-by: Sunil Kumar <sukumar@mvista.com>
---
 src/gatt-database.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/gatt-database.c b/src/gatt-database.c
index 93d6cf7..749858d 100644
--- a/src/gatt-database.c
+++ b/src/gatt-database.c
@@ -1875,7 +1875,7 @@ static bool pipe_io_read(struct io *io, void *user_data)
 				buf, bytes_read,
 				gatt_db_attribute_get_handle(chrc->ccc),
 				chrc->props & BT_GATT_CHRC_PROP_INDICATE,
-				NULL);
+				chrc->proxy);
 
 	return true;
 }
-- 
2.7.4

