From 949c96c9b6643f93a7c1f521ca4a5aa3623467d1 Mon Sep 17 00:00:00 2001
From: Vivek Kumbhar <vkumbhar@mvista.com>
Date: Wed, 22 May 2024 03:41:17 +0000
Subject: [PATCH] CVE-2023-50229

---
 obexd/client/pbap.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/obexd/client/pbap.c b/obexd/client/pbap.c
index 3f5665f..46ecaf8 100644
--- a/obexd/client/pbap.c
+++ b/obexd/client/pbap.c
@@ -298,7 +298,7 @@ static void read_version(struct pbap_data *pbap, GObexApparam *apparam)
		data = value;
	}

-	if (memcmp(pbap->primary, data, len)) {
+	if (len == sizeof(pbap->primary) && memcmp(pbap->primary, data, len)) {
		memcpy(pbap->primary, data, len);
		g_dbus_emit_property_changed(conn,
					obc_session_get_path(pbap->session),
@@ -312,7 +312,8 @@ static void read_version(struct pbap_data *pbap, GObexApparam *apparam)
		data = value;
	}

-	if (memcmp(pbap->secondary, data, len)) {
+	if (len == sizeof(pbap->secondary) &&
+			memcmp(pbap->secondary, data, len)) {
		memcpy(pbap->secondary, data, len);
		g_dbus_emit_property_changed(conn,
					obc_session_get_path(pbap->session),
--
2.24.4
