From: Debian DNS Team <team+dns@tracker.debian.org>
Date: Thu, 29 Apr 2021 13:06:03 +0200
Subject: Buffer overflow in  GSSAPI security policy negotiation
 (CVE-2020-8625)

Origin: vendor
Forwarded: not-needed
Last-Update: 2021-02-09

Upstream-Status: Backport 
https://sources.debian.org/data/main/b/bind9/1%3A9.11.5.P4%2Bdfsg-5.1%2Bdeb10u5/debian/patches/0027-CVE-2020-8625.patch
CVE: CVE-2020-8625
Signed-off-by: Armin Kuster <akuster@mvista.com>

---
 lib/dns/spnego.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/dns/spnego.c b/lib/dns/spnego.c
index ad77f24..28ead69 100644
--- a/lib/dns/spnego.c
+++ b/lib/dns/spnego.c
@@ -877,7 +877,7 @@ der_get_oid(const unsigned char *p, size_t len, oid *data, size_t *size) {
 		return (ASN1_OVERRUN);
 	}
 
-	data->components = malloc(len * sizeof(*data->components));
+	data->components = malloc((len + 1) * sizeof(*data->components));
 	if (data->components == NULL) {
 		return (ENOMEM);
 	}
