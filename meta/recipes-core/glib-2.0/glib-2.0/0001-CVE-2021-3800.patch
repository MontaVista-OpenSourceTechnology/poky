From 679c4644932d28b0d170bec50fe44843a986e3bf Mon Sep 17 00:00:00 2001
From: Vijay Anusuri <vanusuri@mvista.com>
Date: Tue, 13 Sep 2022 09:37:18 +0000
Subject: [PATCH] CVE-2021-3800

libcharset: Drop a redundant environment variable

It was used for running tests when we built with autotools, but is no
longer used in the Meson build system. If we need something similar in
future, it should be done by adding internal API to override the
directory on a per-call basis, rather than loading a path from a shared
global table every time.

Upstream-Status: Backport from https://gitlab.gnome.org/GNOME/glib/-/commit/3529bb4450a519959a5d9cb787404296322618a1
CVE: CVE-2021-3800
Signed-off-by: Philip Withnall <withnall@endlessm.com>
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 glib/libcharset/localcharset.c | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/glib/libcharset/localcharset.c b/glib/libcharset/localcharset.c
index 0d001f9..293ca4c 100644
--- a/glib/libcharset/localcharset.c
+++ b/glib/libcharset/localcharset.c
@@ -117,11 +117,7 @@ _g_locale_get_charset_aliases (void)
       const char *base = "charset.alias";
       char *file_name;
 
-      /* Make it possible to override the charset.alias location.  This is
-	 necessary for running the testsuite before "make install".  */
-      dir = getenv ("CHARSETALIASDIR");
-      if (dir == NULL || dir[0] == '\0')
-	dir = relocate (LIBDIR);
+      dir = relocate (LIBDIR);
 
       /* Concatenate dir and base into freshly allocated file_name.  */
       {
-- 
2.18.2

