From e98b9eaaba86a7eafc5578b27651c48161064f63 Mon Sep 17 00:00:00 2001
From: Ranier Vilela <ranier_gyn@hotmail.com>
Date: Thu, 7 Nov 2019 12:59:10 +0000
Subject: [PATCH 1/2] Use random seed in xmlDictComputeFastKey

xmlDictComputeFastKey is only used for small tables, so this shouldn't
be a security problem.

Upstream-Status: Backport [https://github.com/GNOME/libxml2/commit/3c8a3e9922cb1203ab5998ec542ce1e4c7fd085a]
CVE: CVE-2023-29469
Signed-off-by: Shubham Kulkarni <skulkarni@mvista.com>
---
 dict.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dict.c b/dict.c
index 0ef3718..64b04c7 100644
--- a/dict.c
+++ b/dict.c
@@ -445,7 +445,7 @@ xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {
     unsigned long value = seed;

     if (name == NULL) return(0);
-    value = *name;
+    value += *name;
     value <<= 5;
     if (namelen > 10) {
         value += name[namelen - 1];
--
2.7.4
