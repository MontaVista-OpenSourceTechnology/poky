From 6c716d491dd2e67f08066f4dc0619efeb49e43e6 Mon Sep 17 00:00:00 2001
From: Nick Wellnhofer <wellnhofer@aevum.de>
Date: Thu, 13 Feb 2025 16:48:53 +0100
Subject: [PATCH] pattern: Fix compilation of explicit child axis

The child axis is the default axis and should generate XML_OP_ELEM like
the case without an axis.
---
 pattern.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

This fixes CVE-2025-27113.

Signed-off-by: Javier Campos <jcampos@mvista.com>

Index: libxml2-2.9.5/pattern.c
===================================================================
--- libxml2-2.9.5.orig/pattern.c
+++ libxml2-2.9.5/pattern.c
@@ -1175,10 +1175,10 @@ xmlCompileStepPattern(xmlPatParserContex
 			    goto error;
 			}
 		    } else {
-			PUSH(XML_OP_CHILD, token, URL);
+			PUSH(XML_OP_ELEM, token, URL);
 		    }
 		} else
-		    PUSH(XML_OP_CHILD, name, NULL);
+		    PUSH(XML_OP_ELEM, name, NULL);
 		return;
 	    } else if (xmlStrEqual(name, (const xmlChar *) "attribute")) {
 		XML_PAT_FREE_STRING(ctxt, name)
