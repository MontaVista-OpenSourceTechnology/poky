From f8aaf1c1e5ec2de5345e93932ee01a6aba67c910 Mon Sep 17 00:00:00 2001
From: vivek kumbhar <vkumbhar@mvista.com>
Date: Wed, 23 Mar 2022 11:29:23 +0000
Subject: [PATCH] CVE-2021-43618 gmp

---
 mpz/inp_raw.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/mpz/inp_raw.c b/mpz/inp_raw.c
index b7994a3..dcd9323 100644
--- a/mpz/inp_raw.c
+++ b/mpz/inp_raw.c
@@ -89,8 +89,12 @@ mpz_inp_raw (mpz_ptr x, FILE *fp)
 
   abs_csize = ABS (csize);
 
+  if (UNLIKELY (abs_csize > ~(mp_bitcnt_t) 0 / 8))
+
+    return 0; /* Bit size overflows */
+
   /* round up to a multiple of limbs */
-  abs_xsize = BITS_TO_LIMBS (abs_csize*8);
+  abs_xsize = BITS_TO_LIMBS ((mp_bitcnt_t) abs_csize * 8);
 
   if (abs_xsize != 0)
     {
-- 
2.18.2

