From 29d547cacb3f49d99fcaa0b5b8a92e530b10cafd Mon Sep 17 00:00:00 2001
From: Anand Je Sypureddy <anandje@mvista.com>
Date: Mon, 30 Mar 2020 17:47:07 +0530
Subject: [PATCH] Fixes JIT non-UTF bug.

Upstream status: backport(https://vcs.pcre.org/pcre2?view=revision&revision=1092)
CVE: CVE-2019-20454 patch #1

Signed-off-by: Anand Je Sypureddy <anandje@mvista.com>
---
 src/pcre2_jit_compile.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/pcre2_jit_compile.c b/src/pcre2_jit_compile.c
index 80ed1c4..e22592b 100644
--- a/src/pcre2_jit_compile.c
+++ b/src/pcre2_jit_compile.c
@@ -7277,7 +7277,10 @@ int lgb, rgb, ricount;
 PCRE2_SPTR bptr;
 uint32_t c;
 
-GETCHARINC(c, cc);
+/* Patch by PH */
+/* GETCHARINC(c, cc); */
+
+c = *cc++;
 lgb = UCD_GRAPHBREAK(c);
 
 while (cc < end_subject)
-- 
2.26.0

