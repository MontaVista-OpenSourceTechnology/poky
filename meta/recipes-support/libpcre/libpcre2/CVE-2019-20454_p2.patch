From 165d2b08562cc1af5d26a056a6048b2c8d0fc3b5 Mon Sep 17 00:00:00 2001
From: Anand Je Sypureddy <anandje@mvista.com>
Date: Mon, 30 Mar 2020 17:48:19 +0530
Subject: [PATCH] Fix crash when \X is used without UTF in JIT.

Upstream Status: backport(https://vcs.pcre.org/pcre2?view=revision&revision=1091)
CVE: CVE-2019-20454 patch #2

Signed-off-by: Anand Je Sypureddy <anandje@mvista.com>
---
 testdata/testinput4  | 3 +++
 testdata/testoutput4 | 4 ++++
 2 files changed, 7 insertions(+)

diff --git a/testdata/testinput4 b/testdata/testinput4
index 0ef7b8e..029e292 100644
--- a/testdata/testinput4
+++ b/testdata/testinput4
@@ -2301,4 +2301,7 @@
 \= Expect no match     
     \x{123}\x{124}\x{123}
 
+/\X*/
+    \xF3aaa\xE4\xEA\xEB\xFEa
+
 # End of testinput4
diff --git a/testdata/testoutput4 b/testdata/testoutput4
index 6056e6d..577f71f 100644
--- a/testdata/testoutput4
+++ b/testdata/testoutput4
@@ -3729,4 +3729,8 @@ No match
     \x{123}\x{124}\x{123}
 No match
 
+/\X*/
+    \xF3aaa\xE4\xEA\xEB\xFEa
+ 0: \xf3aaa\xe4\xea\xeb\xfea
+
 # End of testinput4
-- 
2.26.0

