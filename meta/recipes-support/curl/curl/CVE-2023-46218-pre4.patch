From ebcd00b9454c10cca139f323f72b4ff293c7562d Mon Sep 17 00:00:00 2001
From: Daniel Stenberg <daniel@haxx.se>
Date: Thu, 23 Jan 2020 09:01:25 +0100
Subject: strcase: turn Curl_raw_tolower into static

Only ever used from within this file.

Upstream-Status: Backport [security.debian.org/debian-security/pool/updates/main/c/curl/curl_7.64.0-4+deb10u8.debian.tar.xz & https://github.com/curl/curl/commit/ea284778f56f2ff3c07b72c584df71d19a043591]
CVE: CVE-2023-46218 #Dependency Patch4
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 lib/strcase.c | 6 ++++--
 lib/strcase.h | 1 -
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/lib/strcase.c b/lib/strcase.c
index c080a5b35..b4334cc78 100644
--- a/lib/strcase.c
+++ b/lib/strcase.c
@@ -26,6 +26,8 @@
 
 #include "strcase.h"
 
+static char raw_tolower(char in);
+
 /* Portable, consistent toupper (remember EBCDIC). Do not use toupper() because
    its behavior is altered by the current locale. */
 char Curl_raw_toupper(char in)
@@ -96,7 +98,7 @@ char Curl_raw_toupper(char in)
 
 /* Portable, consistent tolower (remember EBCDIC). Do not use tolower() because
    its behavior is altered by the current locale. */
-char Curl_raw_tolower(char in)
+static char raw_tolower(char in)
 {
 #if !defined(CURL_DOES_CONVERSIONS)
   if(in >= 'A' && in <= 'Z')
@@ -255,7 +257,7 @@ void Curl_strntolower(char *dest, const char *src, size_t n)
     return;
 
   do {
-    *dest++ = Curl_raw_tolower(*src);
+    *dest++ = raw_tolower(*src);
   } while(*src++ && --n);
 }
 
diff --git a/lib/strcase.h b/lib/strcase.h
index 470c65ff7..d163554c8 100644
--- a/lib/strcase.h
+++ b/lib/strcase.h
@@ -40,7 +40,6 @@ int Curl_safe_strcasecompare(const char *first, const char *second);
 int Curl_strncasecompare(const char *first, const char *second, size_t max);
 
 char Curl_raw_toupper(char in);
-char Curl_raw_tolower(char in);
 
 /* checkprefix() is a shorter version of the above, used when the first
    argument is zero-byte terminated */
-- 
2.30.2

