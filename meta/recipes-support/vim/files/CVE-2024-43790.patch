From cacb6693c10bb19f28a50eca47bc4bc33eccbae3 Mon Sep 17 00:00:00 2001
From: Christian Brabandt <cb@256bit.org>
Date: Thu, 22 Aug 2024 21:40:14 +0200
Subject: [PATCH] CVE-2024-43790

Upstream-Status: Backport from https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc
CVE: CVE-2024-43790

Signed-off-by: Rohini Sangam <rsangam@mvista.com>
---
 src/search.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/search.c b/src/search.c
index d4baa9192..c1e2c08b6 100644
--- a/src/search.c
+++ b/src/search.c
@@ -1446,6 +1446,7 @@ do_search(
 			{
 			    vim_free(msgbuf);
 			    msgbuf = r;
+			    msgbuflen = STRLEN(msgbuf);
 			    // move reversed text to beginning of buffer
 			    while (*r != NUL && *r == ' ')
 				r++;
-- 
2.24.4

