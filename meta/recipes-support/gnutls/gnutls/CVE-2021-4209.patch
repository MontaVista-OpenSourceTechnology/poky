From 272b94909ad64b03f25808c2f748a3f8ecfa7284 Mon Sep 17 00:00:00 2001
From: Vivek Kumbhar <vkumbhar@mvista.com>
Date: Wed, 23 Nov 2022 09:00:12 +0000
Subject: [PATCH] CVE-2021-4209

---
 lib/nettle/mac.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/lib/nettle/mac.c b/lib/nettle/mac.c
index 311bd40..4388523 100644
--- a/lib/nettle/mac.c
+++ b/lib/nettle/mac.c
@@ -455,7 +455,9 @@ static int wrap_nettle_hash_fast(gnutls_digest_algorithm_t algo,
 	if (ret < 0)
 		return gnutls_assert_val(ret);
 
-	ctx.update(&ctx, text_size, text);
+	if (text_size > 0) {
+		ctx.update(&ctx, text_size, text);
+	}
 	ctx.digest(&ctx, ctx.length, digest);
 
 	return 0;
-- 
2.18.2

