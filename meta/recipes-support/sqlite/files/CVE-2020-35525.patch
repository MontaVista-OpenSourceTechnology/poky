From d1dee75df76d3c787295b4c0023f6bdacd6bab46 Mon Sep 17 00:00:00 2001
From: drh <drh@noemail.net>
Date: Thu, 20 Feb 2020 14:08:51 +0000
Subject: [PATCH] Early-out on the INTERSECT query processing following an
 error.

FossilOrigin-Name: a67cf5b7d37d5b1484be32092635faafd8f76e5881898cd9435517c4b287d663

Upstream-Status: Backport
CVE:  CVE-2020-35525
Signed-off-by: Sunil Kumar <sukumar@mvista.com>
---
 sqlite3.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/sqlite3.c b/sqlite3.c
index 8283d8e..200cfc4 100644
--- a/sqlite3.c
+++ b/sqlite3.c
@@ -130857,6 +130857,7 @@ static int multiSelect(
         /* Generate code to take the intersection of the two temporary
         ** tables.
         */
+        if( rc ) break;
         assert( p->pEList );
         iBreak = sqlite3VdbeMakeLabel(pParse);
         iCont = sqlite3VdbeMakeLabel(pParse);
-- 
2.7.4

