From 40406dd9255273d1eb51c0152184fcd5e38e9ffa Mon Sep 17 00:00:00 2001
From: dan <dan@noemail.net>
Date: Mon, 26 Oct 2020 13:24:36 +0000
Subject: [PATCH] Prevent fts5 tokenizer unicode61 from considering '\0' to be
 a token characters, even if other characters of class "Cc" are.

FossilOrigin-Name: b7b7bde9b7a03665e3691c6d51118965f216d2dfb1617f138b9f9e60e418ed2f

Upstream-Status: Backport [https://www.sqlite.org/src/info/aab790a16e1bdff7]
CVE: CVE-2021-20223
Signed-off-by: Sunil Kumar <sukumar@mvista.com>
---
 sqlite3.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/sqlite3.c b/sqlite3.c
index bb496c7..8283d8e 100644
--- a/sqlite3.c
+++ b/sqlite3.c
@@ -227233,6 +227233,7 @@ static void sqlite3Fts5UnicodeAscii(u8 *aArray, u8 *aAscii){
     }
     iTbl++;
   }
+  aAscii[0] = 0;                  /* 0x00 is never a token character */
 }
 
 /*
-- 
2.7.4

