From b42f9d8ebbf5ebba72484c802874102eb0f528f3 Mon Sep 17 00:00:00 2001
From: Vijay Anusuri <vanusuri@mvista.com>
Date: Fri, 9 Sep 2022 09:50:12 +0000
Subject: [PATCH] CVE-2022-35737

Upstream-Status: Backport [https://www.sqlite.org/src/info/aab790a16e1bdff7]
CVE: CVE-2022-35737
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 sqlite3.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/sqlite3.c b/sqlite3.c
index 9c0e9bf..bb496c7 100644
--- a/sqlite3.c
+++ b/sqlite3.c
@@ -28766,7 +28766,8 @@ SQLITE_API void sqlite3_str_vappendf(
       case etSQLESCAPE:           /* %q: Escape ' characters */
       case etSQLESCAPE2:          /* %Q: Escape ' and enclose in '...' */
       case etSQLESCAPE3: {        /* %w: Escape " characters */
-        int i, j, k, n, isnull;
+        i64  i, j, k, n;
+        int isnull;
         int needQuote;
         char ch;
         char q = ((xtype==etSQLESCAPE3)?'"':'\'');   /* Quote character */
-- 
2.18.2

