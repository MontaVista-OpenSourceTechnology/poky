From 5977697bd5e3c5c4a543f7edcbca8b0725cb87b3 Mon Sep 17 00:00:00 2001
From: Niclas Zeising <zeising@daemonic.se>
Date: Tue, 11 Aug 2020 13:44:38 +0200
Subject: [PATCH 7/7] Fix input clients connecting to server

Fix a bug where some input clients can't connect to the input server.
This fixes #117.

FreeBSD bugzilla reference:
https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=248549

Upstream Status: Backport
CVE: CVE-2020-14344-p7

Signed-off-by: Niclas Zeising <zeising@daemonic.se>
Signed-off-by: Sam Kappen <skappen@mvista.com>
---
 modules/im/ximcp/imRmAttr.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/modules/im/ximcp/imRmAttr.c b/modules/im/ximcp/imRmAttr.c
index 919c556..709e64a 100644
--- a/modules/im/ximcp/imRmAttr.c
+++ b/modules/im/ximcp/imRmAttr.c
@@ -1407,7 +1407,7 @@ _XimCountNumberOfAttr(
     *names_len = 0;
     while (total > min_len) {
 	len = attr[2];
-	if (len >= (total - min_len)) {
+	if (len > (total - min_len)) {
 	    return 0;
 	}
 	*names_len += (len + 1);
-- 
2.18.2

