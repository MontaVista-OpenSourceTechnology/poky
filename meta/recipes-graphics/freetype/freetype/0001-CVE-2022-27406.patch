From a2713bf8dc36ba5c488a60f9f71de8cc27354188 Mon Sep 17 00:00:00 2001
From: Hitendra Prajapati <hprajapati@mvista.com>
Date: Tue, 3 May 2022 16:01:41 +0530
Subject: [PATCH] CVE-2022-27406

Upstream-Status: Backport from https://gitlab.freedesktop.org/freetype/freetype/-/commit/0c2bdb01a2e1d24a3e592377a6d0822856e10df2

Signed-off-by: Hitendra Prajapati <hprajapati@mvista.com>
---
 src/base/ftobjs.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/base/ftobjs.c b/src/base/ftobjs.c
index 9c0e5ad..70ba6e7 100644
--- a/src/base/ftobjs.c
+++ b/src/base/ftobjs.c
@@ -3253,6 +3253,9 @@
     if ( !face )
       return FT_THROW( Invalid_Face_Handle );
 
+    if ( !face->size )
+      return FT_THROW( Invalid_Size_Handle );
+
     if ( !req || req->width < 0 || req->height < 0 ||
          req->type >= FT_SIZE_REQUEST_TYPE_MAX )
       return FT_THROW( Invalid_Argument );
-- 
2.25.1

