From 09895c29dabf7c5aafbafd1f6fb7d7d379e47ad3 Mon Sep 17 00:00:00 2001
From: Vivek Kumbhar <vkumbhar@mvista.com>
Date: Wed, 3 May 2023 04:11:40 +0000
Subject: [PATCH] CVE-2023-2004

---
 src/truetype/ttgxvar.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/truetype/ttgxvar.c b/src/truetype/ttgxvar.c
index 0cedb6b..31fcb63 100644
--- a/src/truetype/ttgxvar.c
+++ b/src/truetype/ttgxvar.c
@@ -43,6 +43,7 @@
 #include FT_INTERNAL_DEBUG_H
 #include FT_CONFIG_CONFIG_H
 #include FT_INTERNAL_STREAM_H
+#include <freetype/internal/ftcalc.h>
 #include FT_INTERNAL_SFNT_H
 #include FT_TRUETYPE_TAGS_H
 #include FT_TRUETYPE_IDS_H
@@ -1046,7 +1047,7 @@
                 delta,
                 vertical ? "VVAR" : "HVAR" ));

-    *avalue += delta;
+    *avalue = ADD_INT( *avalue, delta );

   Exit:
     return error;
--
2.18.2
