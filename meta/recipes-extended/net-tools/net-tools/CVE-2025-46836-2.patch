From 27ddc744bb2dcfba4a1e0836e8c0f5869d1c8c58 Mon Sep 17 00:00:00 2001
From: Bernd Eckenfels <net-tools@lina.inka.de>
Date: Sat, 17 May 2025 21:53:23 +0200
Subject: Interface statistic regression after 7a8f42fb2

Upstream-Status: Backport [import from debian 1.60-26+deb8u1
Upstream commit https://github.com/ecki/net-tools/commit/ddb0e375fb9ca95bb69335540b85bbdaa2714348]
CVE: CVE-2025-46836 #Regression Fix
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 lib/interface.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/lib/interface.c b/lib/interface.c
index 65d84d0..3eb20c5 100644
--- a/lib/interface.c
+++ b/lib/interface.c
@@ -239,12 +239,11 @@ char *get_name(char *name, char *p)
                 /* copy the digits */
                 while (*p && isdigit((unsigned char)*p) && dst < end)
                     *dst++ = *p++;
-
-                if (*p == ':')              /* consume trailing colon     */
-                    ++p;
             } else {              /* if so treat as normal */
                 p = dot;
             }
+            if (*p == ':')                  /* consume trailing colon */
+                ++p;
             break;                          /* interface name ends here   */
         }
 
-- 
2.30.2

