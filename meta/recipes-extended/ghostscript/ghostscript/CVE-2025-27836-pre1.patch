From 328d27b3cccc89c4ff60529106489a9a635f0f72 Mon Sep 17 00:00:00 2001
From: Julian Smith <jules@op59.net>
Date: Fri, 8 Nov 2019 11:32:41 +0000
Subject: Bug 701854: bj10v_print_page(): increase buffer by one byte to give
 space for sentinel.

Fixes:
    ./sanbin/gs -r928 -sOutputFile=tmp -sDEVICE=bj10v ../bug-701854.ps

Upstream-Status: Backport [https://cgit.ghostscript.com/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=328d27b3cccc89c4ff60529106489a9a635f0f72]
CVE: CVE-2025-27836 #Dependency Patch
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 contrib/japanese/gdev10v.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/contrib/japanese/gdev10v.c b/contrib/japanese/gdev10v.c
index aa641de9b..f4c349d18 100644
--- a/contrib/japanese/gdev10v.c
+++ b/contrib/japanese/gdev10v.c
@@ -219,7 +219,8 @@ bj10v_print_page(gx_device_printer *pdev, gp_file *prn_stream)
         int x_skip_unit = bytes_per_column * (xres / 180);
         int y_skip_unit = (yres / 180);
         byte *in = (byte *)gs_malloc(pdev->memory->non_gc_memory, 8, line_size, "bj10v_print_page(in)");
-        byte *out = (byte *)gs_malloc(pdev->memory->non_gc_memory, bits_per_column, line_size, "bj10v_print_page(out)");
+        /* We need one extra byte in <out> for our sentinel. */
+        byte *out = (byte *)gs_malloc(pdev->memory->non_gc_memory, bits_per_column * line_size + 1, 1, "bj10v_print_page(out)");
         int lnum = 0;
         int y_skip = 0;
         int code = 0;
-- 
cgit v1.2.3

